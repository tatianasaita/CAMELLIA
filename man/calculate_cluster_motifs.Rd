% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculate_cluster_motifs.R
\name{calculate_cluster_motifs}
\alias{calculate_cluster_motifs}
\title{Calculate Cluster Motifs from K-mer Counts}
\usage{
calculate_cluster_motifs(x, ...)
}
\arguments{
\item{x}{Object of class 'cluster_dendrogram_result' from cluster_dendrogram().}

\item{...}{Additional arguments passed to methods.}

\item{data_result}{Optional. List containing 'kmers' and 'metadata' data.frames.
If NULL, extracted from x$data_result. Output from create_data() with
cluster assignments added by cluster_dendrogram().}
}
\value{
A data.frame with k-mer motifs by cluster (normalized).
Rows are k-mers, columns are clusters. Values are normalized between 0 and 1
independently for each cluster column.
}
\description{
Calculates motif profiles for each cluster by summing k-mer counts of all
sequences in the cluster. The resulting motif matrix is normalized using
min-max normalization applied independently to each cluster column.
}
\details{
The function performs the following steps:
\enumerate{
\item \strong{Validation:} Checks that input contains cluster assignments
in metadata
\item \strong{Extraction:} Gets k-mer counts and cluster assignments
\item \strong{Aggregation:} For each cluster, sums k-mer values across
all member sequences
\item \strong{Matrix construction:} Creates a matrix with k-mers as rows
and clusters as columns
\item \strong{Normalization:} Applies min-max normalization (0-1 range)
independently to each cluster column
}

Min-max normalization formula (applied per column):
\code{x_normalized = (x - min(column)) / (max(column) - min(column))}

If all values in a column are identical (min == max), they are set to 0.5
to avoid division by zero.
}
\examples{
\dontrun{
# After running create_data, create_dendrogram, and cluster_dendrogram:
motif_cluster <- calculate_cluster_motifs(cluster_result)

# View normalized motif matrix
head(motif_cluster)

# Visualize motifs
heatmap(as.matrix(motif_cluster))
}

}
