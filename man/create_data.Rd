% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/create_data.R
\name{create_data}
\alias{create_data}
\title{Create K-mer Count Data from FASTA Files}
\usage{
create_data(input, k = 6L, alphabet = Biostrings::DNA_ALPHABET[1:4])
}
\arguments{
\item{input}{Character string. Path to directory containing FASTA files
with .fasta extension. The directory must exist and contain at least
one FASTA file.}

\item{k}{Integer. Length of k-mers to count. Must be a positive integer,
typically between 4 and 8 for DNA sequences. Default: 6.}

\item{alphabet}{Character vector. Alphabet to use for k-mer generation.
Default: \code{Biostrings::DNA_ALPHABET[1:4]} (A, C, G, T).}
}
\value{
A list with two elements:
\describe{
\item{kmers}{Data frame with k-mer counts. Rows represent sequences,
columns represent k-mers plus a 'CLASS' column with class labels.
Row names correspond to sequence identifiers from FASTA files.}
\item{metadata}{Data frame with sequence metadata containing:
\describe{
\item{sequence_name}{Sequence identifier from FASTA header}
\item{length}{Sequence length in nucleotides}
\item{class}{Class name extracted from FASTA filename (without extension)}
}}
}
}
\description{
Reads DNA sequences from FASTA files in a directory, counts k-mer occurrences,
and returns a list containing k-mer counts and sequence metadata.
}
\details{
The function processes all FASTA files in the specified directory:
\enumerate{
\item Validates input parameters
\item Discovers all .fasta files in the input directory
\item For each FASTA file:
\itemize{
\item Extracts class name from filename
\item Reads DNA sequences using \code{\link[Biostrings]{readDNAStringSet}}
\item Counts k-mers for each sequence
\item Stores metadata and k-mer counts
}
\item Combines results into a single data frame
\item Returns both k-mer counts and metadata
}

Expected directory structure:
\preformatted{
input_directory/
  ├── class1.fasta
  ├── class2.fasta
  └── class3.fasta
}
}
\examples{
\dontrun{
# Create k-mer data from FASTA files
result <- create_data(
  input = "/path/to/fasta/directory",
  k = 6
)

# Access k-mer counts
kmer_df <- result$kmers
head(kmer_df[, 1:10])

# Access metadata
metadata <- result$metadata
head(metadata)

# Check class distribution
table(metadata$class)

# Filter sequences by class
hiv_indices <- which(metadata$class == "HIV")
hiv_kmers <- result$kmers[hiv_indices, ]
}

}
\seealso{
\code{\link[Biostrings]{readDNAStringSet}} for reading FASTA files,
\code{\link[Biostrings]{DNA_ALPHABET}} for available alphabets.
}
