% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/create_dendrogram.R
\name{create_dendrogram}
\alias{create_dendrogram}
\title{Create and plot a dendrogram from the given dataset}
\usage{
create_dendrogram(
  data,
  sequence_names = NULL,
  dist_method = "euclidean",
  hclust_method = "ward.D2",
  output = NULL,
  use_parallel = TRUE,
  n_threads = NULL,
  plot_title = "Dendrogram",
  show_labels = TRUE
)
}
\arguments{
\item{data}{A data frame containing k-mer counts and a 'CLASS' column.}

\item{sequence_names}{Character vector of sequence names (optional). If provided,
these names will appear on dendrogram leaves instead of class labels.}

\item{dist_method}{A character string specifying the distance method (default: "euclidean").
Options: "euclidean", "maximum", "manhattan", "canberra", "binary", "minkowski".}

\item{hclust_method}{A character string specifying the hierarchical clustering method
(default: "ward.D2"). Options: "ward.D", "ward.D2", "single", "complete",
"average", "mcquitty", "median", "centroid".}

\item{output}{A character string specifying the output file path for saving the dendrogram
plot as a PNG image. If NULL, the plot will be displayed in the R graphics device.}

\item{use_parallel}{Logical. Use parallel processing for distance calculation when
available (default: TRUE). Recommended for datasets with >100 samples.}

\item{n_threads}{Integer. Number of threads to use for parallel processing. If NULL,
uses \code{detectCores() - 1}.}

\item{plot_title}{Character. Title for the dendrogram plot (default: "Dendrogram").}

\item{show_labels}{Logical. Show sample labels on dendrogram (default: TRUE).}
}
\value{
A list (invisibly) containing:
\describe{
\item{dendrogram}{The dendrogram object (class "dendrogram") with colored leaves}
\item{hclust}{The hierarchical clustering object (class "hclust")}
\item{order}{Integer vector with the order of samples in the dendrogram}
\item{labels}{Character vector with ordered class labels}
\item{sequence_names}{Character vector with ordered sequence names (if provided)}
\item{colors}{Character vector with color mapping for each sample}
\item{base_colors}{Named character vector with color mapping for each class}
\item{height}{Numeric value representing the dendrogram height}
\item{n_samples}{Integer, number of samples}
\item{n_classes}{Integer, number of classes}
}
}
\description{
This function creates a dendrogram using optimized distance calculation methods.
It automatically selects the most efficient algorithm based on data size and
available packages. For large datasets (>100 samples), it uses parallelized
distance calculation when available.
}
\details{
The dendrogram leaves are colored according to their class using R's default
palette colors for optimal visual distinction.

The function uses different distance calculation methods based on data size:
\itemize{
\item Small datasets (<100 rows): \code{stats::dist()}
\item Medium datasets (100-500 rows): \code{parallelDist::parDist()} (if available)
\item Large datasets (>500 rows): \code{parallelDist::parDist()} with optimized parameters
}

For clustering, it uses \code{fastcluster::hclust()} when available (faster than
\code{stats::hclust()}), otherwise falls back to base R implementation.

Color selection uses R's default palette and qualified color schemes for optimal
visualization with up to 12 classes. For more classes, rainbow colors are used.

All plots are generated using base R graphics, with optional colored leaves when
the dendextend package is available.
}
\examples{
# Create sample data
data <- data.frame(
  kmer1 = rnorm(100),
  kmer2 = rnorm(100),
  CLASS = rep(c("A", "B"), each = 50)
)

# Basic usage
result <- create_dendrogram(data)

# With sequence names and save to file
\dontrun{
result <- create_dendrogram(
  data,
  sequence_names = paste0("seq_", 1:100),
  output = "dendrogram.png"
)
}

}
